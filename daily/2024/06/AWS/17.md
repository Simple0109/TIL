### セキュリティグループ
インスタンスに対するトラフィックを制御する仮想**ファイアウォール**  
セキュリティグループは許可するインバウンド、アウトバウンドのポートと送信元/送信先を許可するリスト   
デフォルトではインバウンド（受信）ルールがない（暗黙的に全て拒否する）ため、許可するものだけを設定する許可リスト
セキュリティグループの送信元/送信先には`CIDR`もしくはセキュリティグループIDを指定できる     

### ネットワークACL
サブネットに対して設定するファイアウォール  
デフォルトで全てのインバウンド（受信）とアウトバウンド（送信）が許可されている。許可の設定も可能だが、拒否するものを設定する拒否リストとして使用できる。    
※特定のIPアドレスからのアクセスを拒否する場合等に使用   

### VPCフローログ
VPC内のネットワークトラフィックのログを出力する 
トラブルシューティングや外部からの侵入などのインシデント調査に使用される    
※S3, CloudWatch, Kinesis Data Firehoseのいずれかに出力することができる  

## ハイブリッド環境構成
既存のオンプレミス環境からVPCまたは専用線でオンプレミス環境の拡張先としてAWSを使用することができる。    
オンプレミスとクラウドの両方を活用する構成を**ハイブリッド環境構成**と呼ぶ  

### VPN接続
AWSに作成した**仮想プライベートゲートウェイ**とオンプレミス側のカスタマーゲートウェイを指定して`VPN接続`することができる。例えば社内のプライベートネットワークのみで稼働する業務アプリケーションをAWSで実現できる       
仮想プライベートゲートウェイはVPCに1つアタッチすることができる。インターネットゲートウェイ同様可用性、冗長性に優れている。
※`VPN`:Vitual Private Networkの略。日本語にすると「仮想専用通信網」     
VPnでインターネットに接続することをVPN接続と呼ぶ。  
普段共用で使用しているインターネット回線の送信側、受信側にそれぞれ設置した機器で「カプセル化」と呼ばれる処理を行うことで、第三者に見えない仮想的なトンネルを京成して通信することで、仮想的な専用線をインターネット上に作る技術。    
インターネットは公衆回線のため、秘匿性の高い情報の改善や漏洩を防ぐため。    
また独自に専用線を引くことも可能だが、手間がかかり、専任者を置いて管理する必要がある、またコストも高いためVPNが使用される       

### AWS Direct Connect
オンプレミス側のカスタマーゲートウェイと接続する際に、帯域の確保、セキュリティとコンプライアンス要件を満たすために専用線を使用することもできる  
AWS Direct Connectを使用することでAWSとオンプレミスとの間位にプライベートなネットワークを確立することができる。

### VPN接続とAWS Direct Connectの比較
* VPN接続：低コストで手軽にAWSと接続したい場合や、帯域幅やレイテンシにそれほど厳密な要求がない場合
* AWS Direct Connect：高帯域幅、低レイテンシ、そして高いセキュリティが必要な場合（※特にデータセンターとAWS間で大量のデータのやりとりをする必要がある場合有効）  

### VPCピアリング接続
オンプレミスとの接続以外にも、複数のVPC同士を接続する機能。VPCピアリング接続を使用すると、同じアカウントだけでなく、別のリージョン、別のアカウントの複数のVPCとも接続することが可能

## Amazon CloudFront
世界中にある600以上のエッジロケーションを使って最も低いレイテンシでコンテンツを配信できるコンテンツ配信ネットワーク(CDN)     
S3から直接配信したちELB経由のEC2から配信するよりもCloudFrontにキャッシュを持ち、ユーザーにはキャッシュコンテンツを配信するほうが、より早く効率的にコンテンツを提供できる
※`CDN`：`Content Delivary Network`の略でWebコンテンツを迅速に効率よくユーザーに配信するためのネットワーク。CDNを使用すればサーバーからの応答に時間のかかりやすい状況(動画など配信するコンテンツが大容量、アクセス集中、物理的に離れている場所からのアクセス等)でもコンテンツの配信をスピーディに行える。
### CloudFrontの特徴
* キャッシュによる低レイテンシ配信  
S3から直接ELBもしくはEC2からwebコンテンツを配信しているとするときCloudFrontを使っていないと、ユーザーはその都度オリジナルコンテンツにアクセスする必要がある 
CloudFrontを使用しない場合、距離が離れていたり、アクセスが集中しているなどの理由で、配信に遅延が生じてしまう    
CloudFrontを使用してエッジロケーションにキャッシュを持つことで同じ場所にいる3人のユーザーがアクセスしたとき、オリジナルコンテンツを取得するのは1人目のみで2、3人目はCloudFrontのキャッシュを取得することができるので、素早く配信内容を受け取れ る   
* ユーザーの近くから手レイテンシ配信    
コンテンツの配信元と取得したいユーザーの距離が物理的に離れている場合(日本-アメリカ)、ユーザー近くのエッジロケーションにキャッシュが残っている場合、そのキャッシュからユーザーに直接コンテンツが配信できる   
またエッジロケーションにキャッシュがない場合も、エッジロケーションとリージョンはAWSのグローバスネットワークを経由しているので、ユーザーが直接アクセスするよりも効率のいいネットワークパフォーマンスが得られる   
* 安全性の高いセキュリティ
CloudFrontはユーザーが所有しているドメインの証明書を設定できる。そのためユーザーからHTTPSのアクセスを受け取ることができ、通信データを保護できる     
証明書は`AWS Certificate Manager`を使用すると追加費用なしで作成、管理できる 
またCloudFrontに`AWS Shield`や`AWS WAF`といった追加費用無しのセキュリティサービスを組み合わせることで外部からの攻撃や脅威から保護できる

## Amazon Route 53
DNS（ドメインネームシステム）サービス   
Route53はエッジローケーションで使用される       
### 様々なルーティング機能
* シンプルルーティング：単一のIPアドレス情報を回答
* レイテンシーベースのルーティング：１つのドメインに対して複数のDNSレコードを用意しておき、地理的な場所を知覚してレイテンシが低くなるようにする
* 加重ルーティング：1つのドメインに対して複数のDNSレコードを用意しておき、割合を決める
※加重ルーテイングについて、これは1のリクエストに対する処理を分けるものではなく、100件のリクエストがあった場合に30件、70件と処理するサーバーを分けるもの     
リクエストが1件の場合は決めた割合の確率で処理するサーバーが変わる   

### 高可用性を実現するヘルスチェックとフェイルオーバー
Route53ではそれぞれのルーティングにヘルスチェックを組み合わせることができる 
またルーティングの種類の1に`フェイルオーバー`があり、プライマリ（第一候補）とセカンダリ（第二候補）を設定し、プライマリがなんらかの理由でヘルスチェックが失敗したとき、セカンダリのレコードで一時的に「しばらくお待ちください」のようなページを表示するためのS3バケットのURLを回答することができる   
そしてプライマリが復旧すれば元のルーティングに戻る      

## AWS Global Accelerator
Route53よりも高速なフェイルオーバー。Route53と同様にエッジロケーションで用いられる  
複数のリージョンに同じシステムを展開していると仮定したときGlobal Acceleratorをを1つ作成して、エンドポイントに書くリージョンを設定する。アクセラレータは静的で固定化されたエニーキャストIPアドレスが設定される。このIPアドレスにアクセスがあった際には、最寄りのエッジロケーションが入り口となり、最寄りのシステムにルーティングされる。 
ヘルスチェック機能により障害を検知した場合は次に近いリージョンへ即時にフェイルオーバーする  

### AWS Certificate Manager(ACM)
ユーザーが所有しているドメインでアクセスを受けるWebアプリケーションやサイトをHTTPS通信で保護するために必要なSSL/TSL証明書を作成して管理できるサービス       
CloudFrontやELBに設定することができる。設定するとHTTPSで所有ドメインにアクセスすることができる。    
ACMによって得られる証明書の年次更新は自動で行われ、その際にはサーバーを停止する必要も手動で設定し直す必要もない
※HTTPS通信：インターネット上で安全にデータを送受信するためのプロトコル。HTTPにSSL/TLSを組み合わせてデータの暗号化を実現している     
 ユーザーのブラウザとウェブサーバー間の通信を暗号化し、データの盗聴や改ざんを防止する
※インターネット上でデータを暗号化するための技術。SSL証明書やTLS証明書は、ウェブサーバーの身元を証明し、安全な通信を確立するために必要   
 証明書を使ってサーバーの身元を証明し、暗号化通信を確立することで、ユーザーが安心してデータを送受信できるようにする。

### AWS Shield
AWSで実行しているアプリケーションをDDos攻撃から保護するサービス 
ELBやCloudFrontなどがShieldの保護対象   
Shieldには**Standard**と**Advanced**の2つの提供形態がある   
* AWS Shield Standard
AWSサービスのエンドポイントのネットワーク層、トランスポートそうへのDDos攻撃を防御している。AWSの標準機能として無料で提供されており、ユーザーがなにも設定しなくてもAWSサービスのエンドポイントはShield Standardで保護される  
* AWS Shield Advanced   
年間契約で月額3,000USDのサブスクで使用できる。Advancedに加入すると**SRT(Shield Response Team)**というセキュリティエンジニアチームに問い合わせをしてやりとりができる。またWAFとFirewallが無料で使用することができ、レポートなどモニタリングできる内容が増える   

### OCI参照モデル
コンピューターが通信するために利用するネットワークの機能を7つの階層(レイヤー)に分類して整理したモデルのこと。各層ごとに通信プロトコルが定義されている   
各層は「layer」の頭文字をとって「L＋数字」で表すこともある  
数字が小さいほど物理的なレイヤーに近づく、数字が大きいほどアプリケーション的なレイヤーとなる    

* 第7層　アプリケーション層
ユーザーが操作するアプリケーションが提供する具体的機能についての使用や通信手段を定めたもの
* 第6層　プレゼンテーション層
データの表現形式を定義するもので、例えば文字コードの変換などが含まれる
* 第5層　セッション層
通信プログラム間の開始から終了までの一連の手順（セッション）を定義するもので、接続の回復を試みる際の手順などが含まれる
* 第4層　トランスポート層
通信の品質をコントロールするそうであり、信頼性重視やリアルタイム重視用途応じてプロトコルを使い分けることができる
* 第3層　ネットワーク層
ネットワークにおける通信経路の選択（ルーティング）や中継を行う
* 第2層　データリンク層
直接的に接続された機器同士の通信を実現する
* 第1層　物理層
ケーブルやコネクターにて接即される。そのためハードウェアのコネクターの形状やピン数といった物理的な接続の規定をプロトコルとして規定している

### AWS WAF
AWS Shield Standardによってネットワーク層、トランスポート層への攻撃は防げるが、アプリケーション層への攻撃は守られていない   
アプリケーションに対して特定のリクエストパターンを許可するかどうかは、そのアプリケーションの要件によって異なる。    
例えばアプリケーションの管理画面には特定のIPアドレス以外からのアクセスはさせないなdお、特定のリクエストパターンに対して、許可や拒否を行うために`WAF`を利用する  
AWS WAFでは`Web ACL`というルールの入れ物を作ってCloudFront、ALB、API Gatewayなどにアタッチする。`Web ACL`にはリクエストを許可するか拒否するかを判定するための条件をルールとして作成することができる、またAWSがあらかじめ作成している`AWS マネージドルール`も存在そ、こちらはすぐに使うことができる  
`AWS Firewall Manager`で組織で決められたルール通りに複数アカウントでWAFの設定がきちんとされているか一元管理できる（設定されていない場合、自動設定することもできる） 

